/**
 * @company CREASANT DIGITAL
 * @project HKUST EEFACT
 * @author  Jimmy LAU <jimmylau@creasant.com>
 * @version 2.0.0
 * @since   2018-05-08
 */

var MainApp=MainApp||function(r,e,l,t){var i=l("body").hasClass("dev-mode"),n="HKUST-EEFACT",a="v2.0.0",o=!!r.console,c="JML",s=!0,d=1024,u={name:"",msg:""},m="."+c,h=function(e){l.extend(u,e),i&&o&&console.log("FX: "+u.name,u)},p=function(){return o&&console.log("%c JML %c "+n+" ("+a+") %c","background:#2c3e50;padding:1px;border-radius:3px 0 0 3px;color:#fff;","background:#2980b9;padding:1px;border-radius:0 3px 3px 0;color: #fff;","background:transparent;"),c+" "+a},g=function(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n},_=function(){var a,c,i,o;h({name:"navHamburger"}),l(".header-desktop__trigger").on("click",function(){l(this).toggleClass("active"),l(".header-desktop__menu").toggleClass("active"),l(".header-menu-overlay").toggleClass("active")}),l(r).on("resize",(a=function(){l(".header-desktop__trigger").removeClass("active"),l(".header-desktop__menu").removeClass("active"),l(".header-menu-overlay").removeClass("active")},c=250,function(){var e=this,t=arguments,n=i&&!o;clearTimeout(o),o=setTimeout(function(){o=null,i||a.apply(e,t)},c),n&&a.apply(e,t)}))},f=function(){h({name:"scrollToID"}),l(".go-links__link").on("click",function(e){e.preventDefault();var t=l(this).attr("href");l("html, body").animate({scrollTop:l(t).offset().top},500)})},k=function(e,t){switch(h({name:"getDaysOfMon"}),t-1){case 1:return e%4==0&&e%100||e%400==0?29:28;case 8:case 3:case 5:case 10:return 30;default:return 31}},v=function(e){h({name:"initSelectYMD"});var t=l("#checkin_dd, #checkout_dd"),n=l("#checkin_mm, #checkout_mm"),a=l("#checkin_yy, #checkout_yy");switch(e=e||"all"){case"day":t.select2({minimumResultsForSearch:-1,width:"100%",placeholder:"DD"});break;case"month":n.select2({minimumResultsForSearch:-1,width:"100%",placeholder:"MM"});break;case"year":a.select2({minimumResultsForSearch:-1,width:"100%",placeholder:"YYYY"});break;default:t.select2({minimumResultsForSearch:-1,width:"100%",placeholder:"DD"}),n.select2({minimumResultsForSearch:-1,width:"100%",placeholder:"MM"}),a.select2({minimumResultsForSearch:-1,width:"100%",placeholder:"YYYY"})}},y=function(){h({name:"goLinkTab"}),l(".go-links__link").on("click",function(){l(".go-links__link").removeClass("active"),l(this).addClass("active")})},b=function(){h({name:"goLinkPageTop"});var n=l(".go-links").offset().top;l(r).on("scroll",function(n,a,c){var i,o,r,l=null,s=0;c||(c={});var d=function(){s=!1===c.leading?0:Date.now(),l=null,r=n.apply(i,o),l||(i=o=null)};return function(){var e=Date.now();s||!1!==c.leading||(s=e);var t=a-(e-s);return i=this,o=arguments,t<=0||a<t?(l&&(clearTimeout(l),l=null),s=e,r=n.apply(i,o),l||(i=o=null)):l||!1===c.trailing||(l=setTimeout(d,t)),r}}(function(){var e=l(r).width(),t=l(r).scrollTop();d<e&&(n<=t?(i&&o&&console.log("Go-Link: enter"),l(".go-links").addClass("stuck")):(i&&o&&console.log("Go-Link: leave"),l(".go-links").removeClass("stuck")))},300))},q=function(){0<l(".page-transport").length&&(h({name:"pageTransport"}),h({name:"tabMenuSwitch"}),l(".tab-menu__link").on("click",function(e){e.preventDefault(),l(".tab-menu__link").removeClass("active"),l(this).addClass("active");var t=l(this).data("tab");l(".tab-content__page").removeClass("active"),l("."+t).addClass("active")}))};return{app:n,name:"ðŸ‡¯ ðŸ‡²  ðŸ‡± ðŸ‡¦ ðŸ‡º - ðŸ‡² ðŸ‡¦ ðŸ‡® ðŸ‡³ ðŸ‡¦ ðŸ‡µ ðŸ‡µ ",version:p,init:function(){if(p(),!s)return i&&o&&console.log("Re-Run Prevented"),!1;s=!1,i&&o&&console.warn("DEBUG MODE: ON  (Please turn off in PRODUCTION)"),l("body").hasClass("dev-mode")&&(l("body").append('<div class="design"></div>').append('<div class="control"></div>'),l(".control").on("click",function(){l(".design").toggleClass("show")})),_(),h({name:"objectFitPolyfill"}),objectFitImages("img.ofi",{watchMQ:!0}),function(){if(0<l(".group-form").length){h({name:"pageForm"});var e=l("select"),t=l("#checkin_mm, #checkout_mm"),n=l("#checkin_yy, #checkout_yy"),a=l("#checkin_dd");e.select2({minimumResultsForSearch:-1,width:"100%"}),v(),t.on("select2:select",function(){var e,t,n,a,c=l(this).find("option:selected").val();if(l(this).is("#checkin_mm")){if(t=l("#checkin_dd").find("option"),n=l("#checkin_yy").find("option:selected").val(),a=k(n,c),n&&0<n.length)if(t.length-1>a)for(e=t.length-1;a<e;e--)l("#checkin_dd").find("option[value="+e+"]").remove();else for(e=t.length;e<=a;e++)l("#checkin_dd").append('<option value="'+e+'">'+e+"</option>");l("#checkin_dd").val(null).trigger("change")}else{if(t=l("#checkout_dd").find("option"),n=l("#checkout_yy").find("option:selected").val(),a=k(n,c),n&&0<n.length)if(t.length-1>a)for(e=t.length-1;a<e;e--)l("#checkout_dd").find("option[value="+e+"]").remove();else for(e=t.length;e<=a;e++)l("#checkout_dd").append('<option value="'+e+'">'+e+"</option>");l("#checkout_dd").val(null).trigger("change")}i&&o&&console.log("Y-M (D): ",n+" - "+c+" ("+a+") "),v()}),n.on("select2:select",function(){l(this).is("#checkin_yy")?(l("#checkin_dd").val(null).trigger("change"),l("#checkin_mm").val(null).trigger("change")):(l("#checkout_dd").val(null).trigger("change"),l("#checkout_mm").val(null).trigger("change"))}),a.on("select2:select",function(){var e=l("#checkin_dd").val();l("#checkout_dd").find("option").each(function(){l(this).removeAttr("disabled")});for(var t=24;t<=e;t++)l("#checkout_dd").find('option[value="'+t+'"]').attr("disabled","disabled");v("day"),l("#checkout_dd").val(null).trigger("change")})}}(),0<l(".page-home").length&&h({name:"pageHome"}),0<l(".page-register").length&&(h({name:"pageRegister"}),l("#register-form").validate({rules:{part_salutation:{required:!0},part_lastname:{required:!0},part_firstname:{required:!0},part_fullname:{required:!0},part_email:{required:!0,email:!0},part_institution:{required:!0},part_title:{required:!0},cont_salutation:{required:!0},cont_lastname:{required:!0},cont_firstname:{required:!0},cont_fullname:{required:!0},cont_email:{required:!0,email:!0},cont_institution:{required:!0},cont_title:{required:!0},campus:{required:!0},checkin_dd:{required:"#campus_on:checked"},checkin_mm:{required:"#campus_on:checked"},checkout_dd:{required:"#campus_on:checked"},checkout_mm:{required:"#campus_on:checked"},checkout_yy:{required:"#campus_on:checked"},room:{required:"#campus_on:checked"},guest_share_t:{required:"#room_twin:checked"},guest_share_d2:{required:"#room_double2:checked"},allergy:{required:!0},allergy_content:{required:"#allergy_yes:checked"},letter:{required:!0},abstract:{required:!0},accept_terms_conditions:{required:!0},accept_email:{required:!0},captcha:{required:!0,maxlength:4}},errorPlacement:function(e,t){"SELECT"===t[0].tagName.toUpperCase()&&t.siblings(".select2").each(function(){l(this).hasClass("select2-container--disabled")||(l(this).addClass("error"),l(this).off("click"+m).on("click"+m,function(){l(this).removeClass("error")}))})}}),l("#same_part_info").on("click",function(){var e=l("#cont_salutation, #cont_lastname, #cont_firstname, #cont_fullname, #cont_email, #cont_institution, #cont_title");l("#same_part_info").prop("checked")?(e.prop("disabled",!0).prop("required",!1).rules("remove"),l(".cont_field").slideUp(),l(".contact-info label.error").remove(),l(".contact-info input.error").removeClass("error")):(l(".cont_field").slideDown(),e.prop("disabled",!1).prop("required",!0).rules("add",{required:!0}),l("#cont_email").rules("add",{email:!0}))}),l(".campus-selected").hasClass("campus-back")||l(".campus-selected").slideUp(),l("#campus_off").on("click",function(){l(".campus-selected").slideUp()}),l("#campus_on").on("click",function(){l(".campus-selected").slideDown()}),l("#register-form").on("submit",function(e){var t=l("#checkin_yy").val()+"-"+g(l("#checkin_mm").val(),2)+"-"+g(l("#checkin_dd").val(),2),n=l("#checkout_yy").val()+"-"+g(l("#checkout_mm").val(),2)+"-"+g(l("#checkout_dd").val(),2);try{var a=new Date(t),c=new Date(n);"[object Date]"===Object.prototype.toString.call(a)&&"[object Date]"===Object.prototype.toString.call(c)&&(isNaN(a.getTime()&&!isNaN(c))||c.getTime()<a.getTime()&&(alert("Check-out Date should be later than Check-in Date!"),e.preventDefault()))}catch(e){console.log(e)}var i=l("#captcha").val(),o=l("#mycode2").val();i&&0<i.length&&i!==o&&(alert("Please check the captcha and input again"),e.preventDefault())}),l('input[name="allergy"]').on("click",function(){"allergy_yes"===l(this).attr("id")?l("#allergy_content").prop("disabled",!1):l("#allergy_content").prop("disabled",!0)}),l('input[name="room"]').on("click",function(){"room_twin"===l(this).attr("id")?(l("#guest_share_t").prop("disabled",!1),l("#guest_share_d2").prop("disabled",!0)):("room_double2"===l(this).attr("id")?l("#guest_share_d2").prop("disabled",!1):l("#guest_share_d2").prop("disabled",!0),l("#guest_share_t").prop("disabled",!0))}),void 0!==l('input[name="allergy"]:checked').val()&&l('input[name="allergy"]:checked').trigger("click"),void 0!==l('input[name="room"]').val()&&l('input[name="room"]:checked').trigger("click")),0<l(".page-information").length&&(h({name:"pageInformation"}),y(),f(),b()),0<l(".page-program").length&&(h({name:"pageProgram"}),y(),f(),b()),q()}}}(this,this.document,jQuery);MainApp.init();